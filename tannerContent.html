<!DOCTYPE html>
<html>
  <head>
    <title>Professors by Difficulty</title>
    <meta name="description" content="My ratings of several Missouri S&T professors.  Very useful information for students.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv=Content-Type content="text/html; charset=utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script type='text/javascript'>
      function loadFile(filePath) {
        var result = null;
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("GET", filePath, false);
        xmlhttp.send();
        if (xmlhttp.status==200) {
          result = xmlhttp.responseText;
        }
        return result;
      }

      function get_part(line, index, index_of_last_comma) {
        // pre: line[index] === ',' or index === line.length
        let part = line.slice(index_of_last_comma + 1, index);
        if(part[0] === '"' && part[part.length - 1] === '"') {
          part = part.slice(1, part.length - 1);
        }
        return part;
      }

      function parseCSVline(line) {
        let inQuotes = false;
        let parts = [];
        let index_of_last_comma = -1;
        line.split('').forEach((char, index) => {
          if(char === '"') {
            inQuotes = !inQuotes;
          } else if(!inQuotes) {
            if(char === ',') {
              parts.push(get_part(line, index, index_of_last_comma));
              index_of_last_comma = index;
            }
          }
        });
        if(line.length - 1 > index_of_last_comma) {
          parts.push(get_part(line, line.length, index_of_last_comma));
        }
        return parts;
      }

      function onLoad() {
        let fileContent = loadFile('ProfessorsInOrderOfDifficulty.csv');
        lines = fileContent.split(/\r|\n/);
        let isFirstLine = true;
        document.getElementById('contentTable').innerHTML = lines.map(line => {
          let tag = 'td';
          if(isFirstLine) {
            tag = 'th';
          }
          let html = '<tr>' + parseCSVline(line).map(part => '<' + tag + ' style="border: 1px solid black;">' + part + '</' + tag + '>').join('') + '</tr>';
          isFirstLine = false;
          return html;
        }).join('\n');
      }
    </script>
  </head>
  <body onload="onLoad();">
    <table id='contentTable'></table>
  </body>
</html>
