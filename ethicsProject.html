<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      const LESSONS = {
        1 : {
          questions : [
            {
              'q' : "A trolley is approaching along its track.  If it stays on its track, it will run over five people who are tied down to its track.  If you pull a lever, the trolley would be diverted to another track with only one person tied down.  According to Utilitarianism, should you pull the lever or not?  Why?",
              'a' : [
                "Pull the lever because it is 4 lives better than not pulling the lever.",
                "Don't pull the lever because you should not intervene without permission.",
                "Pull the lever because it would demonstrate a good amount of courage.",
              ],
              'c' : 0,
              'e' : 'Utilitarianism says to maximize net aggregate hapiness.  Saving 5 lives for the cost of 1 life is the better option, so Utilitarianism would obligate you to pull the lever.',
            },
          ],
        },
      };

      const VIDEO_WIDTH_NORMAL = 640;
      const VIDEO_HEIGHT_NORMAL = 480;
      const VIDEO_WIDTH_SMALL = 320;
      // const VIDEO_HEIGHT_SMALL = 240;
      // const VIDEO_WIDTH_LARGE = 1000;
      // const VIDEO_HEIGHT_LARGE = 240;

      function setupOnClicks(lessonID) {
        questions = LESSONS[lessonID].questions;
        questions.forEach(function(question, question_index) {
          question.a.forEach(function(answer, answer_index) {
            const answerChoiceId = generateAnswerChoiceId(lessonID, question_index, answer_index);
            const questionId = generateQuestionId(lessonID, question_index);
            const is_correct = answer_index == question.c;
            document.getElementById(answerChoiceId).onclick = function(){
              document.getElementById(answerChoiceId).classList.remove('btn-default');
              document.getElementById(answerChoiceId).classList.add('btn-' + (is_correct ? 'success' : 'danger'));
              if(is_correct) {
                document.getElementById(questionId).hidden = false;
              }
            }
          });
        });
      }

      var myVideo = document.getElementById("video1"); 

      function playPause() { 
        if (myVideo.paused) {
          myVideo.play();
          document.getElementById('videoStatusDisplay').innerHTML = "Playing";
        }else{
          myVideo.pause();
          document.getElementById('videoStatusDisplay').innerHTML = "Paused"
        } 
      } 

      // function makeBig() { 
      //     myVideo.width = VIDEO_WIDTH_LARGE; 
      // } 

      function makeSmall() { 
          myVideo.width = VIDEO_WIDTH_SMALL; 
      } 

      function makeNormal() { 
          myVideo.width = VIDEO_WIDTH_NORMAL; 
      } 

      function generateQuestionId(lessonID, question_index) {
        return String(lessonID) + ":" + String(question_index);
      }

      function generateAnswerChoiceId(lessonID, question_index, answer_index) {
        return String(lessonID) + ":" + String(question_index) + ":" + String(answer_index);
      }

      function generateLesson(lessonID) {
        material = LESSONS[lessonID].material;
        questions = LESSONS[lessonID].questions;
        let html = "";
        // html += '<iframe width="420" height="315" src="Presentation1.mp4?rel=0&cc_load_policy=1">';
        // html += '</iframe>'
        html += '<button onclick="playPause()">Play/Pause</button>';
        // html += '<button onclick="makeBig()">Big</button>';
        html += '<button onclick="makeSmall()">Small</button>';
        html += '<button onclick="makeNormal()">Normal</button>';
        html += '<span id="videoStatusDisplay"></span>';
        html += '<div style="background-color: black; text-align: center;">';
        html += '<video id="video1" width="' + VIDEO_WIDTH_NORMAL + '" height="' + VIDEO_HEIGHT_NORMAL + '">';
        html += '<source src="Presentation' + String(lessonID) + '.mp4" type="video/mp4">';
        html += 'Your browser does not support the video tag.';
        html += '</video>';
        html += '</div>';
        html += '<hr></hr>';
        html += '<h3>Questions</h3>';
        questions.forEach(function(question, question_index) {
          html += '<h4>';
          html += question.q;
          html += '</h4>';
          html += '<table><tbody>';
          question.a.forEach(function(answer, answer_index) {
            answerChoiceId = generateAnswerChoiceId(lessonID, question_index, answer_index);
            html += '<tr><td><div';
            html += ' id="' + answerChoiceId + '"';
            html += 'class="btn btn-default">';
            html += answer;
            html += '</div></td></tr>';
          });
          html += '</tbody></table>';
          html += '<div hidden="true" id="' + generateQuestionId(lessonID, question_index) + '">';
          html += question.e;
          html += '</div>';
        });
        return html;
      }

      function onLoad() {
        let lessonID = 1;
        document.getElementById("content").innerHTML = generateLesson(lessonID);
        myVideo = document.getElementById("video1"); 
        setupOnClicks(lessonID);
      }
    </script>
  </head>
  <body onLoad="onLoad()">
    <div class="container">
      <h3>Ethics Project</h3>
      <div id="content"></div>
    </div>
    <hr>
    <footer>
      <p style="text-align: center;">Tanner Winkelman - Philosophy 3235 Project</p>
    </footer>
  </body>
</html>
